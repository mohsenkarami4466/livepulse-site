<!DOCTYPE html>
<html lang="fa" dir="rtl" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LivePulse.ir - قیمت لحظه‌ای ارز، طلا و رمزارز</title>
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <!-- استایل‌های اصلی - تقسیم شده -->
    <link rel="stylesheet" href="./styles/variables.css?v=2.8">
    <link rel="stylesheet" href="./styles/error-handler.css?v=2.8">
    <!-- Components Styles - تقسیم شده -->
    <link rel="stylesheet" href="./styles/components/globe.css?v=2.8">
    <link rel="stylesheet" href="./styles/components/cards.css?v=2.8">
    <link rel="stylesheet" href="./styles/components/sections.css?v=2.8">
    <link rel="stylesheet" href="./styles/components/modals.css?v=2.8">
    <link rel="stylesheet" href="./styles/components/price-modal.css?v=2.8">
    <link rel="stylesheet" href="./styles/components/other.css?v=2.8">
    <link rel="stylesheet" href="./styles/responsive.css?v=2.8">
    <link rel="stylesheet" href="./globe/globe-styles.css?v=2.8">
    <link rel="stylesheet" href="./styles/themes-complete.css?v=2.8"> <!-- تم‌های کامل و تفکیک شده -->
    <link rel="stylesheet" href="./styles/theme-optimization.css?v=2.8"> <!-- Theme optimization -->
    
    <!-- کتابخانه‌های اصلی (برای استفاده در React components) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    
    <!-- کتابخانه‌های Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/three-globe@2.27.3/dist/three-globe.min.js"></script>
    
    <!-- D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    
    <!-- html2canvas برای تولید عکس -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Utilities - باید قبل از React app لود شوند -->
    <script src="./utils/logger.js"></script>
    <script src="./utils/error-handler.js"></script>
    <script src="./utils/performance.js"></script>
    <script src="./utils/globe-helpers.js"></script>
    <script src="./utils/state-manager.js"></script>
    <script src="./config.js"></script>
    
    <!-- Main Scripts - برای integration با React -->
    <script src="./script-main.js"></script>
    <script src="./script-views.js"></script>
    <script src="./script-cards.js"></script>
    
    <!-- Globe Scripts - تقسیم شده به فایل‌های کوچک‌تر -->
    <!-- Globe Globals - متغیرهای global -->
    <script src="./globe/globals.js"></script>
    <!-- Globe Helpers - توابع کمکی -->
    <script src="./globe/globe-helpers.js"></script>
    <!-- Globe Clock - کره کوچک و ساعت بازار -->
    <script src="./globe/globe-clock.js"></script>
    <!-- Globe Markets - توابع بازار -->
    <script src="./globe/globe-markets.js"></script>
    <!-- Globe Modals - توابع مودال -->
    <script src="./globe/globe-modals.js"></script>
    <!-- Globe Simple - ساخت کره ساده -->
    <script src="./globe/globe-simple.js"></script>
    <!-- Globe Resources - توابع کره منابع -->
    <script src="./globe/globe-resources.js"></script>
    <!-- Globe 3D - توابع کره‌های 3D -->
    <script src="./globe/globe-3d.js"></script>
    
    <script src="./script-ui.js"></script>
    <script src="./script-tools.js"></script>
    <script src="./data/countries-data.js"></script>
    <script src="./gold-map.js"></script>
    <script src="./data/geo-borders.js"></script>
    <script src="./script-init.js"></script>
</head>
<body data-theme="light" style="margin: 0; padding: 0;">
    <div id="root"></div>

    <!-- Container برای ساعت بازار اصلی -->
    <div id="globeContainer" style="
        position: fixed;
        top: 10px;
        left: 10px;
        width: 180px;
        height: 180px;
        z-index: 10000;
        pointer-events: auto;
        cursor: pointer;
        background: transparent;
        overflow: hidden;
        border-radius: 50%;
    "></div>

    <script type="module" src="/src/main.jsx"></script>

    <!-- Fallback: فعال‌سازی کره کوچک در صورت عدم وجود React GlobeClock -->
    <script>
        // این کد فقط به عنوان fallback عمل می‌کند
        // اگر React GlobeClock کار کند، این کد اجرا نمی‌شود
        (function() {
            // صبر می‌کنیم تا React render شود
            setTimeout(function() {
                // بررسی اینکه آیا React GlobeClock وجود دارد
                const reactGlobeClock = document.querySelector('#globeClockWrapper[data-react-mode="true"]');
                if (reactGlobeClock) {
                    // React GlobeClock وجود دارد، نیازی به fallback نیست
                    return;
                }
                
                // اگر React GlobeClock وجود ندارد، fallback را فعال می‌کنیم
                const log = window.logger || { info: console.log, warn: console.warn };
                log.info('⚠️ React GlobeClock پیدا نشد - استفاده از fallback');
                
                // ایجاد container و wrapper
                let container = document.getElementById('globeContainer');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'globeContainer';
                    container.style.cssText = 'position: fixed; top: 10px; left: 10px; width: 180px; height: 180px; z-index: 10000; background: transparent; overflow: hidden; border-radius: 50%;';
                    document.body.appendChild(container);
                }
                
                let wrapper = document.getElementById('globeClockWrapper');
                if (!wrapper) {
                    wrapper = document.createElement('div');
                    wrapper.id = 'globeClockWrapper';
                    wrapper.style.cssText = 'position: fixed; top: 10px; left: 10px; z-index: 10000; width: 180px; height: 180px; overflow: hidden;';
                    document.body.appendChild(wrapper);
                }
                
                // فعال کردن ساعت اصلی
                if (typeof initGlobe === 'function') {
                    try {
                        initGlobe();
                        log.info('✅ Fallback: کره کوچک فعال شد');
                    } catch (error) {
                        log.warn('❌ خطا در فعال‌سازی fallback:', error);
                    }
                }
            }, 2000); // تاخیر 2 ثانیه برای اطمینان از render شدن React
        })();
    </script>

</body>
</html>

